<mat-horizontal-stepper [linear]="true" #stepper>
  <mat-step [stepControl]="tripForm">
    <form [formGroup]="tripForm">
      <ng-template matStepLabel>Order Details</ng-template>
      <div class="step-container">
        <!-- Sender Section -->
        <div class="sender-section">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Pickup Address</mat-label>
            <input matInput #autocompleteInput formControlName="source" placeholder="Address, Zipcode, Country" (input)="onInputChange('source')">
          </mat-form-field>
          <ul *ngIf="predictions.length > 0" class="predictions-list">
            <li *ngFor="let prediction of predictions" (click)="selectPrediction(prediction,'source')">
              {{ prediction.description }}
            </li>
          </ul>
          <button mat-raised-button color="primary" type="button">Edit Address</button>
        </div>
        <!-- Recipient Section -->
        <div class="recipient-section">
          <h3>Recipient Detail</h3>
          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>First Name</mat-label>
              <input matInput formControlName="recipientFirstName" placeholder="Name">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Last Name</mat-label>
              <input matInput formControlName="recipientLastName" placeholder="Family">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Phone</mat-label>
              <input matInput formControlName="recipientPhone" placeholder="Phone">
            </mat-form-field>
          </div>
          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Country</mat-label>
              <input matInput formControlName="recipientCountry" placeholder="Country">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>State</mat-label>
              <input matInput formControlName="recipientState" placeholder="State">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>City</mat-label>
              <input matInput formControlName="recipientCity" placeholder="City">
            </mat-form-field>
          </div>
          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Street</mat-label>
              <input matInput #autocompleteInput2 formControlName="recipientStreet" placeholder="Street" (input)="onInputChangeRecipient('recipientStreet')">

            </mat-form-field>
            <ul *ngIf="recipientPrediction.length > 0" class="predictions-list">
              <li *ngFor="let prediction of recipientPrediction" (click)="selectPrediction(prediction,'recipientStreet')">
                {{ prediction.description }}
              </li>
            </ul>

            <mat-form-field appearance="outline">
              <mat-label>House Number</mat-label>
              <input matInput formControlName="recipientHouseNumber" placeholder="House Number">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Zip Code</mat-label>
              <input matInput formControlName="recipientZipCode" placeholder="Zip Code">
            </mat-form-field>
          </div>
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>More Info</mat-label>
            <textarea matInput formControlName="recipientMoreInfo" placeholder="More Info"></textarea>
          </mat-form-field>
        </div>
        <!-- Goods Section -->
        <div class="goods-section">
          <h3>Goods Information</h3>
          <div class="form-row">
            <mat-form-field appearance="fill">
              <mat-label>Pickup Date</mat-label>
              <input matInput [matDatepicker]="pickupDatePicker" formControlName="pickupDate" placeholder="Pickup date ">
              <mat-datepicker-toggle matSuffix [for]="pickupDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #pickupDatePicker></mat-datepicker>
            </mat-form-field>
            <mat-form-field appearance="fill">
              <mat-label>Dropoff Date</mat-label>
              <input matInput [matDatepicker]="dropoffDatePicker" formControlName="dropoffDate" placeholder="Dropoff date">
              <mat-datepicker-toggle matSuffix [for]="dropoffDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #dropoffDatePicker></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Type</mat-label>
              <mat-select formControlName="typeOfGoods">
                <mat-option value="perishable">Perishable</mat-option>
                <mat-option value="non-perishable">Non-perishable</mat-option>
                <mat-option value="fragile">Fragile</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Quantity</mat-label>
              <input matInput formControlName="capacity" type="number" placeholder="Quantity of goods in kg">
            </mat-form-field>
          </div>
        </div>
        <!-- Comments Section -->
        <div class="comments-section">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Comments</mat-label>
            <textarea matInput formControlName="comments" placeholder="Enter any special requirements for the goods specified"></textarea>
          </mat-form-field>
        </div>
      </div>
      <!-- Button Row -->
      <div class="button-row">
        <button mat-raised-button color="primary" matStepperNext [disabled]="!tripForm.valid"  >Next</button>
      </div>
    </form>
  </mat-step>

  <!-- Step 2: Select Truck -->
  <mat-step [stepControl]="truckSelectionForm">
    <form [formGroup]="truckSelectionForm">
      <ng-template matStepLabel>Select Carrier</ng-template>
      <div class="truck-cards">
        <mat-card *ngFor="let truck of availableTrucks" (click)="selectTruck(truck)" [class.selected]="truckSelectionForm.value.selectedTruck === truck.type">
        <div class="image-placeholder"></div>
        <div class="content">
            <div>
                <div class="title">{{ truck.type }}</div>
                <div class="subtitle">Price per kilometer: {{ truck.pricePerKm }} EUR</div>
                <div class="refrigerated">{{ truck.refrigerated }}</div>
            </div>
            <div>
                <div class="order-info">
                    <div class="order-title">{{ truck.orderType }}</div>
                    <div class="order-details">Pickup: 24-28 July 2024 • {{ truck.destinations }} Destinations</div>
                </div>
                <div class="price-select">
                    <div class="price">€{{ truck.price }}</div>
                    <button class="select-btn">Select</button>
                </div>
            </div>
        </div>
        </mat-card>
      </div>
      <div class="button-row">
        <button mat-raised-button color="primary" matStepperPrevious>Back</button>
        <button mat-raised-button color="primary" matStepperNext (click)="saveUserInput()">Next</button>
      </div>
    </form>
  </mat-step>

<!-- Step 3: Payment Information -->
<mat-step [stepControl]="paymentForm">
  <form [formGroup]="paymentForm">
    <ng-template matStepLabel>Order overview</ng-template>
    <div class="payment-panel">
      <h3>Trip Details</h3>
      <p>Pickup Address: {{ summaryData.trip?.source }}</p>
      <p>Recipient First Name: {{ summaryData.trip?.recipientFirstName }}</p>
      <p>Recipient Last Name: {{ summaryData.trip?.recipientLastName }}</p>
      <p>Recipient Phone: {{ summaryData.trip?.recipientPhone }}</p>
      <p>Recipient Country: {{ summaryData.trip?.recipientCountry }}</p>
      <p>Recipient State: {{ summaryData.trip?.recipientState }}</p>
      <p>Recipient City: {{ summaryData.trip?.recipientCity }}</p>
      <p>Recipient Street: {{ summaryData.trip?.recipientStreet }}</p>
      <p>Recipient House Number: {{ summaryData.trip?.recipientHouseNumber }}</p>
      <p>Recipient Zip Code: {{ summaryData.trip?.recipientZipCode }}</p>
      <p>More Info: {{ summaryData.trip?.recipientMoreInfo }}</p>
      <p>Type of Goods: {{ summaryData.trip?.typeOfGoods }}</p>
      <p>Quantity: {{ summaryData.trip?.capacity }}</p>
      <p>Comments: {{ summaryData.trip?.comments }}</p>

      <h3>Truck Details</h3>
      <p>Selected Truck: {{ summaryData.truck?.selectedTruck }}</p>

      <div class="form-container">
        <div class="form-row">
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>First Name</mat-label>
            <input matInput formControlName="firstName" placeholder="First Name">
          </mat-form-field>
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Last Name</mat-label>
            <input matInput formControlName="lastName" placeholder="Last Name">
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="outline" class="three-quarters-width">
            <mat-label>Credit Card Number</mat-label>
            <input matInput formControlName="cardNumber" placeholder="Card Number" type="password">
          </mat-form-field>
          <mat-form-field appearance="outline" class="quarter-width">
            <mat-label>Security Code</mat-label>
            <input matInput formControlName="cvv" placeholder="CVC" type="password">
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Expiry Date</mat-label>
            <input matInput formControlName="expiryDate" placeholder="MM/YY">
          </mat-form-field>
        </div>
      </div>
    </div>
    <div class="button-row">
      <button mat-raised-button color="primary" matStepperPrevious>Back</button>
      <button mat-raised-button color="primary" type="submit" (click)="onSubmit()">Finish</button>
    </div>
  </form>
</mat-step>
</mat-horizontal-stepper>
